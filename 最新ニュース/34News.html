<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ³¨ç›®AIãƒ‹ãƒ¥ãƒ¼ã‚¹34é¸ï¼šãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³è³‡æ–™ (Gemini APIæ­è¼‰ç‰ˆ)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans JP', sans-serif;
        }
        .slide {
            display: none;
            transition: opacity 0.5s ease-in-out;
        }
        .slide.active {
            display: block;
        }
        .chart-container {
            position: relative;
            height: 250px;
            width: 100%;
            max-width: 400px;
            margin: auto;
        }
        /* Modal styles */
        .modal-content h3 {
            font-size: 1.125rem; /* text-lg */
            font-weight: 700; /* font-bold */
            margin-top: 1rem;
            margin-bottom: 0.5rem;
            color: #334155; /* slate-700 */
        }
        .modal-content ul {
            list-style-type: disc;
            list-style-position: inside;
            padding-left: 1rem;
        }
        .modal-content li {
            margin-bottom: 0.25rem;
        }
    </style>
</head>
<body class="bg-gray-100 flex flex-col items-center justify-center min-h-screen p-4">

    <div class="w-full max-w-4xl bg-white rounded-2xl shadow-2xl overflow-hidden">
        <header class="bg-slate-800 text-white p-4 text-center">
            <h1 class="text-xl md:text-2xl font-bold">æ³¨ç›®AIãƒ‹ãƒ¥ãƒ¼ã‚¹34é¸ï¼šãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³è³‡æ–™</h1>
        </header>

        <main id="slideshow-container" class="relative w-full aspect-[16/9] bg-white">
            <!-- Slides will be injected here by JavaScript -->
        </main>

        <footer class="flex items-center justify-between p-4 bg-slate-100 border-t">
            <button id="prevBtn" class="bg-slate-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-slate-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" /></svg>
            </button>
            <div id="slide-counter" class="text-slate-700 font-semibold">1 / 11</div>
            <button id="nextBtn" class="bg-slate-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-slate-700 transition-colors">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg>
            </button>
        </footer>
    </div>

    <!-- AI Modal -->
    <div id="ai-modal" class="fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center p-4 z-50 hidden">
        <div class="bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] flex flex-col">
            <div class="flex justify-between items-center p-4 border-b">
                <h3 class="text-lg font-bold text-slate-800">âœ¨ AIã«ã‚ˆã‚‹æ·±æ˜ã‚Šåˆ†æ</h3>
                <button id="close-modal-btn" class="text-gray-500 hover:text-gray-800">&times;</button>
            </div>
            <div id="modal-content-area" class="p-6 overflow-y-auto modal-content">
                <!-- AI response will be injected here -->
            </div>
        </div>
    </div>

<script>
const slidesData = [
    {
        title: "01. ChatGPT æ–°ã‚³ãƒã‚¯ã‚¿ Î²ï¼šç¤¾å†…ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹ãŒæ‹¡å¤§",
        tool: "ChatGPT (Plusãƒ—ãƒ©ãƒ³)",
        summary: "Google Driveç­‰ã®å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ã¨é€£æºã—ã€ç¤¾å†…ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¨ªæ–­æ¤œç´¢ãƒ»åˆ†æã§ãã‚‹ã€Œã‚³ãƒã‚¯ã‚¿ã€æ©Ÿèƒ½ãŒç™»å ´ã€‚ç‰¹ã«ã€Œãƒ‡ã‚£ãƒ¼ãƒ—ãƒªã‚µãƒ¼ãƒã€ã¨ã®çµ„ã¿åˆã‚ã›ãŒå¼·åŠ›ã€‚",
        merits: ["åŸ‹ã‚‚ã‚Œã¦ã„ãŸç¤¾å†…ãƒŠãƒ¬ãƒƒã‚¸ã‚’ç™ºè¦‹ãƒ»æ´»ç”¨ã§ãã‚‹", "æƒ…å ±ã®å±äººåŒ–ã‚’é˜²ã"],
        demerits: ["ãƒ‡ã‚£ãƒ¼ãƒ—ãƒªã‚µãƒ¼ãƒã«æ™‚é–“ãŒã‹ã‹ã‚‹ï¼ˆæ•°åˆ†ã€œï¼‰", "æ¤œç´¢ç¯„å›²ãŒåºƒã™ãã‚‹ã¨ç²¾åº¦ãŒè½ã¡ã‚‹"],
        point: "éå»ã®è³‡ç”£ï¼ˆå ±å‘Šæ›¸ãƒ»è­°äº‹éŒ²ï¼‰ã®å†åˆ©ç”¨ã«ã‚ˆã‚Šã€ãƒªã‚µãƒ¼ãƒæ™‚é–“ã‚’åŠ‡çš„ã«çŸ­ç¸®ã—ã€çµ„ç¹”ã®é›†åˆçŸ¥ã‚’æ´»ç”¨ã§ãã‚‹ã€‚",
        visual_type: "flowchart",
        visual_data: { type: 'TD', nodes: [{ id: 'A', text: '<strong>STEP 1: ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹</strong><br>Google Drive, Dropbox, M365' },{ id: 'B', text: '<strong>STEP 2: ChatGPT</strong><br>ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã§æŒ‡ç¤º' },{ id: 'C', text: '<strong>STEP 3: ãƒ‡ã‚£ãƒ¼ãƒ—ãƒªã‚µãƒ¼ãƒ</strong><br>AIãŒãƒ‡ãƒ¼ã‚¿ã‚’æ¨ªæ–­åˆ†æ' },{ id: 'D', text: '<strong>STEP 4: ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆ</strong><br>è¦ç´„ãƒ»ãƒªã‚¹ãƒˆãƒ»ä¼ç”»æ›¸ç”Ÿæˆ' }], edges: [['A', 'B'], ['B', 'C'], ['C', 'D']] }
    },
    {
        title: "02. ChatGPT Recordï¼šéŸ³å£°ã‹ã‚‰çŸ¥è­˜ã‚’æ§‹é€ åŒ–",
        tool: "ChatGPT (Macãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã‚¢ãƒ—ãƒªé™å®š)",
        summary: "Macç‰ˆã‚¢ãƒ—ãƒªã«æ­è¼‰ã•ã‚ŒãŸã€ŒRecordã€ãƒœã‚¿ãƒ³ã§éŸ³å£°ã‚’éŒ²éŸ³ã™ã‚‹ã¨ã€è‡ªå‹•ã§æ–‡å­—èµ·ã“ã—ã¨è¦ç´„ãŒç”Ÿæˆã•ã‚Œã‚‹æ©Ÿèƒ½ã€‚",
        merits: ["ä¼šè­°ã‚„ã‚¢ã‚¤ãƒ‡ã‚¢ã‚’å³åº§ã«ãƒ†ã‚­ã‚¹ãƒˆåŒ–", "æ€è€ƒã‚’æ­¢ã‚ãšã«ãƒ–ãƒ¬ã‚¹ãƒˆå¯èƒ½"],
        demerits: ["Macãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã‚¢ãƒ—ãƒªé™å®š", "ãƒ‡ãƒ¼ã‚¿ã®è“„ç©å…ˆã¨ã—ã¦æœ€é©ã‹ã¯å€‹äººã«ã‚ˆã‚‹"],
        point: "ã€Œè­°äº‹éŒ²ä½œæˆã®å³æ™‚åŒ–ã€ãŒæœ€å¤§ã®ãƒã‚¤ãƒ³ãƒˆã€‚ä¼šè­°çµ‚äº†ã¨åŒæ™‚ã«è­°äº‹éŒ²ãƒ‰ãƒ©ãƒ•ãƒˆãŒå®Œæˆã—ã€ã‚¢ã‚¤ãƒ‡ã‚¢ã‚’å¤±ã†ã“ã¨ãªãæ¬¡ã«ç¹‹ã’ã‚‰ã‚Œã‚‹ã€‚",
        visual_type: "table",
        visual_data: { headers: ["ã‚¹ãƒ†ãƒƒãƒ—", "ã‚¢ã‚¯ã‚·ãƒ§ãƒ³", "èª¬æ˜"], rows: [["<strong>STEP 1</strong>", "ğŸ”´ éŒ²éŸ³é–‹å§‹", "ã‚¢ãƒ—ãƒªã®ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦è©±ã™"],["<strong>STEP 2</strong>", "â¹ï¸ éŒ²éŸ³çµ‚äº†", "éŒ²éŸ³ã‚’åœæ­¢ã™ã‚‹ã¨AIãŒè‡ªå‹•å‡¦ç†"],["<strong>STEP 3</strong>", "âœ¨ ãƒ†ã‚­ã‚¹ãƒˆç”Ÿæˆ", "æ•°ç§’å¾Œã«æ–‡å­—èµ·ã“ã—ã¨è¦ç´„ãŒè¡¨ç¤º"]] }
    },
    {
        title: "03. Gemini 1.5 Proã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰",
        tool: "Gemini 1.5 Pro",
        summary: "AIãƒ¢ãƒ‡ãƒ«ã®ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆï¼ˆ0605ãƒãƒ¼ã‚¸ãƒ§ãƒ³ï¼‰ã«ã‚ˆã‚Šã€æ€è€ƒèƒ½åŠ›ã‚„å›ç­”ã®ç²¾åº¦ãŒã•ã‚‰ã«å‘ä¸Šã€‚",
        merits: ["ç”Ÿæˆã•ã‚Œã‚‹ãƒ†ã‚­ã‚¹ãƒˆã®è³ªã‚„è«–ç†çš„ä¸€è²«æ€§ãŒå‘ä¸Š", "ã‚ˆã‚Šè¤‡é›‘ãªæŒ‡ç¤ºã«å¯¾å¿œå¯èƒ½ã«"],
        demerits: ["ãƒ¢ãƒ‡ãƒ«ã®é€²åŒ–ãŒé€Ÿãã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ç¶™ç¶šçš„ãªè©•ä¾¡ãŒå¿…è¦"],
        point: "AIã®ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆã®è³ªãŒä¸ŠãŒã‚‹ã“ã¨ã§ã€äººé–“ã«ã‚ˆã‚‹æ‰‹ç›´ã—ã®æ™‚é–“ãŒæ¸›ã‚Šã€äº‹æ¥­æˆ¦ç•¥ã®å£æ‰“ã¡ãªã©ã€ã‚ˆã‚Šé«˜åº¦ãªä½œæ¥­ã‚’ä»»ã›ã‚‰ã‚Œã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚",
        visual_type: "table_rating",
        visual_data: { headers: ["è©•ä¾¡è»¸", "æ—§ãƒãƒ¼ã‚¸ãƒ§ãƒ³", "æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ (0605)"], rows: [["è«–ç†çš„æ€è€ƒåŠ›", "â˜…â˜…â˜…â˜†â˜†", "â˜…â˜…â˜…â˜…â˜†"],["æ–‡ç« ç”Ÿæˆã®è³ª", "â˜…â˜…â˜…â˜…â˜†", "â˜…â˜…â˜…â˜…â˜…"],["è¦ç´„ã®ç²¾åº¦", "â˜…â˜…â˜…â˜…â˜†", "â˜…â˜…â˜…â˜…â˜†"],["å¿œç­”é€Ÿåº¦", "â˜…â˜…â˜…â˜†â˜†", "â˜…â˜…â˜…â˜…â˜†"]] }
    },
    {
        title: "04. Geminiã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã§Geminiæ´»ç”¨æ©Ÿèƒ½ã‚’ç°¡å˜è¿½åŠ ",
        tool: "Gemini",
        summary: "GeminiãŒç”Ÿæˆã—ãŸHTMLãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”»é¢ã«ã€ãƒœã‚¿ãƒ³ä¸€ã¤ã§é–¢é€£ã™ã‚‹ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãªAIæ©Ÿèƒ½ï¼ˆã‚­ãƒ£ãƒƒãƒã‚³ãƒ”ãƒ¼ç”Ÿæˆãªã©ï¼‰ã‚’è‡ªå‹•ã§åŸ‹ã‚è¾¼ã‚ã‚‹ã€‚",
        merits: ["ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŸ¥è­˜ãªã—ã§å‹•çš„ãªAIãƒ„ãƒ¼ãƒ«ã‚’è¿½åŠ å¯èƒ½", "ChatGPTã«ã¯ãªã„ãƒ¦ãƒ‹ãƒ¼ã‚¯ãªæ©Ÿèƒ½"],
        demerits: ["æ©Ÿèƒ½ãŒæ°—ã¥ãã«ãã„å ´æ‰€ã«ã‚ã‚‹", "ã¾ã å®Ÿé¨“çš„ã§æ„å›³é€šã‚Šã«å‹•ã‹ãªã„å¯èƒ½æ€§ã‚‚"],
        point: "å˜ãªã‚‹æƒ…å ±å…±æœ‰ãƒ„ãƒ¼ãƒ«ãŒã€å—ã‘æ‰‹ã‚‚å‚åŠ ã§ãã‚‹å¯¾è©±å‹ãƒ„ãƒ¼ãƒ«ã«é€²åŒ–ã€‚ãƒ¬ãƒãƒ¼ãƒˆã«è¦ç´„æ©Ÿèƒ½ã‚’è¿½åŠ ã™ã‚‹ãªã©ã€ã‚ˆã‚Šæ·±ã„ç†è§£ã‚’ä¿ƒã›ã‚‹ã€‚",
        visual_type: "flowchart",
        visual_data: { type: 'TD', nodes: [{ id: 'A', text: '<strong>1. ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆå…¥åŠ›</strong><br>ã€Œã‚¤ãƒ³ãƒ•ã‚©ã‚°ãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚’ä½œã£ã¦ã€' },{ id: 'B', text: '<strong>2. GeminiãŒå‡¦ç†</strong>' },{ id: 'C', text: '<strong>3. HTMLãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”Ÿæˆ</strong>' },{ id: 'D', text: '<strong>4. ã€ŒGeminiæ©Ÿèƒ½ã‚’è¿½åŠ ã€</strong><br>ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯' },{ id: 'E', text: '<strong>5. ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–æ©Ÿèƒ½è¿½åŠ </strong><br>ãƒšãƒ¼ã‚¸å†…ã«AIãƒ„ãƒ¼ãƒ«ãŒåŸ‹ã‚è¾¼ã¾ã‚Œã‚‹' }], edges: [['A', 'B'], ['B', 'C'], ['C', 'D'], ['D', 'E']] }
    },
    {
        title: "05. Gemini ã‚¢ãƒ—ãƒªã«Scheduled Actionsæ©Ÿèƒ½ã‚’è¿½åŠ ",
        tool: "Gemini",
        summary: "ã€Œæ¯æœã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚’è¦‹ã¦è¦ç´„ã—ã¦ã€ã®ã‚ˆã†ã«ã€ç‰¹å®šã®æ™‚é–“ã«ã‚¿ã‚¹ã‚¯ã‚’è‡ªå‹•å®Ÿè¡Œã•ã›ã‚‹ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«æ©Ÿèƒ½ãŒè¿½åŠ äºˆå®šã€‚",
        merits: ["Google Workspaceã¨é€£æºã—å¹…åºƒã„å€‹äººãƒ‡ãƒ¼ã‚¿ã‚’æ´»ç”¨å¯èƒ½", "å®šæœŸçš„ãªãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ãƒ¯ãƒ¼ã‚¯ã‚’å®Œå…¨è‡ªå‹•åŒ–"],
        demerits: ["ç™ºè¡¨æ™‚ç‚¹ã§ã¾ã åˆ©ç”¨ä¸å¯", "è¨­å®šã‚„ç®¡ç†ã«ã¯æ…£ã‚ŒãŒå¿…è¦ãªå¯èƒ½æ€§"],
        point: "æ¯æœã®æƒ…å ±åé›†ã‚„æ—¥å ±ä½œæˆã¨ã„ã£ãŸå®šå‹æ¥­å‹™ã‚’AIã«ä¸€ä»»ã§ãã‚‹ã€‚äººé–“ã¯æœä¸€ç•ªã‹ã‚‰é‡è¦ã‚¿ã‚¹ã‚¯ã«é›†ä¸­ã§ãã€ç”Ÿç”£æ€§ãŒå‘ä¸Šã™ã‚‹ã€‚",
        visual_type: "table",
        visual_data: { headers: ["æ™‚é–“ãƒˆãƒªã‚¬ãƒ¼", "AIã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³", "ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆ"], rows: [["æ¯æœ 8:00", "â‘ ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚¹ã‚­ãƒ£ãƒ³<br>â‘¡é‡è¦ãƒ¡ãƒ¼ãƒ«ãƒã‚§ãƒƒã‚¯<br>â‘¢é–¢é€£ãƒ‹ãƒ¥ãƒ¼ã‚¹æ¤œç´¢", "ä»Šæ—¥ã®äºˆå®šè¦ç´„ã¨ã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆã€é–¢é€£æƒ…å ±ãŒã‚¹ãƒãƒ›ã«é€šçŸ¥"],["æ¯é€±é‡‘æ›œ 17:00", "â‘ ä»Šé€±ã®ãƒ¡ãƒ¼ãƒ«å±¥æ­´åˆ†æ<br>â‘¡ä¼šè­°å†…å®¹åˆ†æ", "é€±å ±ã®ãƒ‰ãƒ©ãƒ•ãƒˆãŒè‡ªå‹•ç”Ÿæˆ"]] }
    },
    {
        title: "06. NotebookLMã€ãƒªãƒ³ã‚¯å…±æœ‰ã§ä¸€èˆ¬å…¬é–‹ãŒå¯èƒ½ã«",
        tool: "NotebookLM",
        summary: "è‡ªèº«ãŒä½œæˆã—ãŸãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ï¼ˆæƒ…å ±æºã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ãŸAIãƒãƒ£ãƒƒãƒˆç’°å¢ƒï¼‰ã‚’ã€ãƒªãƒ³ã‚¯ã§èª°ã«ã§ã‚‚å…±æœ‰ã§ãã‚‹ã‚ˆã†ã«ãªã£ãŸã€‚",
        merits: ["å°‚é–€çŸ¥è­˜ãªã—ã§RAGï¼ˆæ¤œç´¢æ‹¡å¼µç”Ÿæˆï¼‰ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆã‚’ç°¡å˜ã«ä½œæˆãƒ»å…±æœ‰å¯èƒ½", "ç¤¾å†…å¤–ã¸ã®æƒ…å ±æä¾›ã‚„ç°¡æ˜“Q&Aãƒ„ãƒ¼ãƒ«ã¨ã—ã¦å¼·åŠ›"],
        demerits: ["Workspaceã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ã¯ã¾ã åˆ©ç”¨ä¸å¯", "å…±æœ‰ã•ã‚ŒãŸå´ã¯æƒ…å ±æºã®ç·¨é›†ã¯ä¸å¯"],
        point: "ã€Œå•ã„åˆã‚ã›å¯¾å¿œã®ã‚»ãƒ«ãƒ•ã‚µãƒ¼ãƒ“ã‚¹åŒ–ã€ãŒå¯èƒ½ã€‚ç¤¾å†…ãƒãƒ‹ãƒ¥ã‚¢ãƒ«ã‚’èª­ã¿è¾¼ã¾ã›ã¦å…±æœ‰ã™ã‚Œã°ã€ã‚ˆãã‚ã‚‹è³ªå•ã«AIãŒ24æ™‚é–“è‡ªå‹•å›ç­”ã—ã€ç®¡ç†éƒ¨é–€ã®å·¥æ•°ã‚’å‰Šæ¸›ã€‚",
        visual_type: "flowchart",
        visual_data: { type: 'LR', nodes: [{ id: 'A', text: '<strong>ä½œæˆè€…</strong><br>è³‡æ–™ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã€å…±æœ‰ãƒªãƒ³ã‚¯ã‚’ç”Ÿæˆ' },{ id: 'B', text: '<strong>å…±æœ‰ã•ã‚ŒãŸäºº</strong><br>ãƒªãƒ³ã‚¯ã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹ã—ã€AIã«è³ªå•' },{ id: 'C', text: '<strong>AI</strong><br>ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸè³‡æ–™ã«åŸºã¥ãå›ç­”' }], edges: [['A', 'B'], ['B', 'C']] }
    },
    {
        title: "29. Anthropic CEOã€AIã«ã‚ˆã‚‹ãƒ›ãƒ¯ã‚¤ãƒˆã‚«ãƒ©ãƒ¼è·ã®å¤§é‡å¤±æ¥­ã‚’è­¦å‘Š",
        tool: "ç”ŸæˆAIå…¨èˆ¬",
        summary: "Anthropicç¤¾CEOãŒã€Œä»Šå¾Œ1ã€œ5å¹´ã§ã€AIãŒã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒ¬ãƒ™ãƒ«ã®ãƒ›ãƒ¯ã‚¤ãƒˆã‚«ãƒ©ãƒ¼è·ã®æœ€å¤§50%ã‚’ä»£æ›¿ã—ã€å¤±æ¥­ç‡ãŒ10ã€œ20%ã«é”ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã€ã¨è­¦å‘Šã€‚",
        merits: ["AIãŒã‚‚ãŸã‚‰ã™è² ã®å´é¢ã‹ã‚‰ç›®ã‚’ãã‚‰ã•ãšã€ç¤¾ä¼šã§å‚™ãˆã‚‹å¿…è¦æ€§ã‚’ä¿ƒã™è­¦å‘Šã€‚"],
        demerits: ["è‹¥å¹´å±¤ã‚’ä¸­å¿ƒã«åºƒç¯„å›²ãªè·ç¨®ã§å¤§è¦æ¨¡ãªé›‡ç”¨å–ªå¤±ãŒç™ºç”Ÿã™ã‚‹å¯èƒ½æ€§ã€‚"],
        point: "ä¼æ¥­ã«ã¨ã£ã¦ã¯ã€Œè‡ªå‹•åŒ–ã§ã‚³ã‚¹ãƒˆå‰Šæ¸›åŠ¹æœãŒé«˜ã„é ˜åŸŸã€ã‚’ç¤ºå”†ã€‚å€‹äººã«ã¨ã£ã¦ã¯ã€AIã«ã¯ã§ããªã„å‰µé€ çš„ãªä»•äº‹ã¸ã®ã‚¹ã‚­ãƒ«ã‚·ãƒ•ãƒˆãŒæ€¥å‹™ã§ã‚ã‚‹ã“ã¨ã‚’ç¤ºã™ã€‚",
        visual_type: "custom",
        html: `<div class="text-center"><h4 class="font-bold text-lg mb-2 text-red-600">AIã«ã‚ˆã‚‹è·å‹™ä»£æ›¿ã®å¯èƒ½æ€§</h4><div class="w-full bg-gray-200 rounded-full my-2"><div class="bg-red-500 text-xs font-medium text-blue-100 text-center p-1 leading-none rounded-full" style="width: 50%"> 50% </div></div><p class="text-sm">ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒ¬ãƒ™ãƒ«ã®ãƒ›ãƒ¯ã‚¤ãƒˆã‚«ãƒ©ãƒ¼è·</p><div class="mt-4 border-t pt-4"><p class="font-semibold">äºˆæ¸¬æœŸé–“: <span class="text-red-600">ä»Šå¾Œ1ã€œ5å¹´</span></p><p class="font-semibold">äºˆæ¸¬å¤±æ¥­ç‡: <span class="text-red-600">10ã€œ20%</span></p></div></div>`
    },
    {
        title: "30. ç”ŸæˆAIåˆ©ç”¨ã§ç”Ÿç”£æ€§ãŒ3å€ã«",
        tool: "ç”ŸæˆAIå…¨èˆ¬",
        summary: "ã‚¹ã‚¿ãƒ³ãƒ•ã‚©ãƒ¼ãƒ‰å¤§å­¦ã®èª¿æŸ»ã§ã€å¤šãã®çŸ¥çš„åŠ´åƒã‚¿ã‚¹ã‚¯ã«ãŠã„ã¦ã€AIåˆ©ç”¨ã«ã‚ˆã‚Šç”Ÿç”£æ€§ãŒå¹³å‡3å€ã«å‘ä¸Šï¼ˆä½œæ¥­æ™‚é–“90åˆ†â†’30åˆ†ï¼‰ã—ãŸã¨ã„ã†çµæœãŒå‡ºãŸã€‚",
        merits: ["ç”Ÿç”£æ€§å‘ä¸Šã®åŠ¹æœãŒãƒ‡ãƒ¼ã‚¿ã§å…·ä½“çš„ã«ç¤ºã•ã‚ŒãŸã€‚", "AIæ´»ç”¨ã«ã‚ˆã‚‹æ™‚é–“å‰µå‡ºã®åŠ¹æœãŒæ˜ç¢ºã«ã€‚"],
        demerits: ["ç‰¹ã«ãªã—"],
        point: "æ—¥å¸¸æ¥­å‹™ã‹ã‚‰ã€Œ90åˆ†ã‹ã‹ã‚‹ã‚¿ã‚¹ã‚¯ã€ã‚’ä¸€ã¤è¦‹ã¤ã‘ã€AIã§30åˆ†ã«çŸ­ç¸®ã™ã‚‹ç›®æ¨™ã‚’ç«‹ã¦ã‚‹ã€‚ã“ã‚Œã‚’å®Ÿè·µã™ã‚Œã°1æ—¥1æ™‚é–“ã€æœˆ20æ™‚é–“ã®æ™‚é–“å‰µå‡ºã«ç¹‹ãŒã‚‹ã€‚",
        visual_type: "chart",
        visual_data: { type: 'bar', labels: ['AIãªã—', 'AIã‚ã‚Š'], datasets: [{ label: 'ã‚¿ã‚¹ã‚¯æ‰€è¦æ™‚é–“ï¼ˆåˆ†ï¼‰', data: [90, 30], backgroundColor: ['rgba(255, 99, 132, 0.5)', 'rgba(75, 192, 192, 0.5)'], borderColor: ['rgb(255, 99, 132)', 'rgb(75, 192, 192)'], borderWidth: 1 }] }
    },
    {
        title: "31. AIæ´»ç”¨ã§æ€ ã‘è€…ã¨è¦‹ãªã•ã‚Œã‚‹ï¼Ÿè·å ´è©•ä¾¡ã¸ã®æ‡¸å¿µ",
        tool: "ç”ŸæˆAIå…¨èˆ¬",
        summary: "è·å ´ã§AIã‚’ä½¿ã†ã¨ã€Œæ¥½ã‚’ã—ã¦ã„ã‚‹ã€ã€Œèƒ½åŠ›ãŒä½ã„ã€ã¨æ€ã‚ã‚Œã‚‹æ‡¸å¿µã‚’ç¤¾å“¡ãŒæŠ±ã„ã¦ã„ã‚‹ã€‚AIã‚’ä½¿ã‚ãªã„ä¸Šå¸ã¯AIã‚’ä½¿ã†éƒ¨ä¸‹ã‚’ãƒã‚¤ãƒŠã‚¹è©•ä¾¡ã™ã‚‹å‚¾å‘ã‚‚ã€‚",
        merits: ["AIå°å…¥ã‚’é˜»ã‚€èª²é¡ŒãŒæ˜ç¢ºã«ãªã£ãŸã€‚"],
        demerits: ["ã€Œæ–‡åŒ–çš„ãªå£ã€ãŒç”Ÿç”£æ€§å‘ä¸Šã‚’é˜»å®³ã—ã¦ã„ã‚‹ã€‚"],
        point: "è§£æ±ºã«ã¯ã€Œä¼æ¥­æ–‡åŒ–ã®å¤‰é©ã€ã¨ã€Œè©•ä¾¡åˆ¶åº¦ã®è¦‹ç›´ã—ã€ãŒä¸å¯æ¬ ã€‚æˆæœãƒ™ãƒ¼ã‚¹ã®è©•ä¾¡ã«ã‚·ãƒ•ãƒˆã—ã€çµŒå–¶å±¤ãŒAIåˆ©ç”¨ã‚’æ¨å¥¨ã™ã‚‹æ–‡åŒ–ã‚’é†¸æˆã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚",
        visual_type: "custom",
        html: `<div class="grid grid-cols-2 grid-rows-2 gap-1 w-full h-full text-white text-xs md:text-sm text-center"><div class="bg-green-500 p-2 flex flex-col justify-center items-center rounded-tl-lg"><strong>ä¸Šå¸:åˆ©ç”¨<br>éƒ¨ä¸‹:åˆ©ç”¨</strong><br>ãƒ—ãƒ©ã‚¹è©•ä¾¡</div><div class="bg-red-500 p-2 flex flex-col justify-center items-center rounded-tr-lg"><strong>ä¸Šå¸:éåˆ©ç”¨<br>éƒ¨ä¸‹:åˆ©ç”¨</strong><br>ãƒã‚¤ãƒŠã‚¹è©•ä¾¡</div><div class="bg-blue-500 p-2 flex flex-col justify-center items-center rounded-bl-lg"><strong>ä¸Šå¸:åˆ©ç”¨<br>éƒ¨ä¸‹:éåˆ©ç”¨</strong><br>ãƒ—ãƒ©ã‚¹è©•ä¾¡</div><div class="bg-gray-500 p-2 flex flex-col justify-center items-center rounded-br-lg"><strong>ä¸Šå¸:éåˆ©ç”¨<br>éƒ¨ä¸‹:éåˆ©ç”¨</strong><br>å½±éŸ¿ãªã—</div></div>`
    },
    {
        title: "32. æ—¥æœ¬ã®å¤§æ‰‹ä¼æ¥­ã€ç”ŸæˆAIè‡ªç¤¾é–‹ç™ºã®é«˜ROIé”æˆã¯2å‰²æœªæº€",
        tool: "è‡ªç¤¾é–‹ç™ºã®ç”ŸæˆAIãƒ„ãƒ¼ãƒ«",
        summary: "ã‚¨ã‚¯ã‚µã‚¦ã‚£ã‚¶ãƒ¼ã‚ºã®èª¿æŸ»ã§ã€å¤šãã®æ—¥æœ¬ä¼æ¥­ãŒç”ŸæˆAIãƒ„ãƒ¼ãƒ«ã‚’è‡ªç¤¾é–‹ç™ºã—ã¦ã„ã‚‹ãŒã€é«˜ã„æŠ•è³‡å¯¾åŠ¹æœï¼ˆROIï¼‰ã‚’é”æˆã—ã¦ã„ã‚‹ã®ã¯2å‰²æœªæº€ã€‚",
        merits: ["æˆåŠŸä¼æ¥­ã¯ã€ç¤¾å†…å•ã„åˆã‚ã›å¯¾å¿œãªã©æ˜ç¢ºãªç›®çš„ã‚’æŒã£ã¦æ´»ç”¨ã—ã¦ã„ã‚‹ã€‚"],
        demerits: ["è‡ªç¤¾é–‹ç™ºã¯é«˜ã‚³ã‚¹ãƒˆã§ã€æŠ€è¡“é€²åŒ–ã¸ã®è¿½éšãŒå›°é›£ã€‚", "SaaSè£½å“ã«æ¯”ã¹ç¤¾å“¡ã®åˆ©ç”¨ç‡ã‚‚ä½ã„å‚¾å‘ã€‚"],
        point: "ã€Œè»Šè¼ªã®å†ç™ºæ˜ã€ã‚’é¿ã‘ã‚‹ã¹ãã€‚å¸‚å ´ã®å„ªã‚ŒãŸSaaSã‚’åŸºç›¤ã¨ã—ã€ãã®ä¸Šã§è‡ªç¤¾æ¥­å‹™ã«ç‰¹åŒ–ã—ãŸãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’æ§‹ç¯‰ã™ã‚‹æ–¹ãŒåŠ¹ç‡çš„ã‹ã¤ä½ãƒªã‚¹ã‚¯ã€‚",
        visual_type: "chart",
        visual_data: { type: 'pie', labels: ['é«˜ã„ROIã‚’é”æˆ', 'é”æˆã§ããš / ä¸æ˜'], datasets: [{ data: [18, 82], backgroundColor: ['rgba(75, 192, 192, 0.7)', 'rgba(255, 99, 132, 0.7)'], borderColor: 'white', borderWidth: 2 }] }
    },
    {
        title: "34. å°ä¸­å­¦ç”Ÿã®AIåˆ©ç”¨å®Ÿæ…‹",
        tool: "ChatGPTãªã©",
        summary: "ãƒ‹ãƒ•ãƒ†ã‚£ã®èª¿æŸ»ã§ã€å°å­¦ç”Ÿã®50.7ï¼…ã€ä¸­å­¦ç”Ÿã®60.6ï¼…ãŒChatGPTã®åˆ©ç”¨çµŒé¨“ã‚ã‚Šã¨å›ç­”ã€‚è‹¥å¹´å±¤ã¸ã®AIæµ¸é€ãŒæ€¥é€Ÿã«é€²ã‚“ã§ã„ã‚‹ã€‚",
        merits: ["å­ã©ã‚‚ãŸã¡ãŒAIãƒã‚¤ãƒ†ã‚£ãƒ–ã¨ã—ã¦è‚²ã£ã¦ã„ã‚‹ã€‚"],
        demerits: ["å®¶åº­ã‚„å­¦æ ¡ã§ã®åˆ©ç”¨ãƒ«ãƒ¼ãƒ«ãŒå®šã‚ã‚‰ã‚Œã¦ã„ã‚‹ã®ã¯1å‰²ç¨‹åº¦ã¨å°‘ãªãã€ä¸æ­£åˆ©ç”¨ã‚„ãƒªãƒ†ãƒ©ã‚·ãƒ¼æ•™è‚²ã«èª²é¡Œã€‚"],
        point: "ã€Œ5ã€œ10å¹´å¾Œã‚’è¦‹æ®ãˆãŸäººææˆ¦ç•¥ã€ã§é‡è¦ã€‚æ¬¡ä¸–ä»£ã®åŠ´åƒè€…ã¯AIã‚’å½“ãŸã‚Šå‰ã«ä½¿ã„ã“ãªã—ã¦å…¥ç¤¾ã—ã¦ãã‚‹ã€‚å½¼ã‚‰ã®ã‚¹ã‚­ãƒ«ã‚’æ´»ã‹ã›ã‚‹ã‚ˆã†ã€ä¼æ¥­ã¯æ¥­å‹™ãƒ•ãƒ­ãƒ¼ã‚„ç ”ä¿®åˆ¶åº¦ã‚’é€²åŒ–ã•ã›ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚",
        visual_type: "chart",
        visual_data: { type: 'bar', labels: ['å°å­¦ç”Ÿ', 'ä¸­å­¦ç”Ÿ'], datasets: [{ label: 'ChatGPTåˆ©ç”¨çµŒé¨“ç‡ (%)', data: [50.7, 60.6], backgroundColor: ['rgba(153, 102, 255, 0.6)', 'rgba(255, 159, 64, 0.6)'], borderColor: ['rgb(153, 102, 255)', 'rgb(255, 159, 64)'], borderWidth: 1 }], options: { indexAxis: 'y' } }
    }
];

const slideshowContainer = document.getElementById('slideshow-container');
const slideCounter = document.getElementById('slide-counter');
const prevBtn = document.getElementById('prevBtn');
const nextBtn = document.getElementById('nextBtn');
const aiModal = document.getElementById('ai-modal');
const closeModalBtn = document.getElementById('close-modal-btn');
const modalContentArea = document.getElementById('modal-content-area');

let currentSlide = 0;
const charts = [];

function createFlowchart(data) {
    const container = document.createElement('div');
    container.className = `flex ${data.type === 'TD' ? 'flex-col' : 'flex-row'} items-center justify-center gap-2 h-full p-2`;
    data.nodes.forEach((node, index) => {
        const nodeEl = document.createElement('div');
        nodeEl.className = 'bg-sky-100 border-2 border-sky-500 rounded-lg p-3 text-center text-xs md:text-sm shadow-md';
        nodeEl.innerHTML = node.text;
        container.appendChild(nodeEl);
        if (index < data.nodes.length - 1) {
            const arrow = document.createElement('div');
            arrow.className = 'text-sky-500 font-bold text-2xl';
            arrow.innerHTML = data.type === 'TD' ? 'â†“' : 'â†’';
            container.appendChild(arrow);
        }
    });
    return container;
}

function createTable(data) {
    const table = document.createElement('table');
    table.className = 'w-full text-left border-collapse text-xs md:text-sm';
    const thead = table.createTHead();
    const headerRow = thead.insertRow();
    headerRow.className = 'bg-slate-200';
    data.headers.forEach(headerText => {
        const th = document.createElement('th');
        th.className = 'p-2 border border-slate-300 font-semibold';
        th.textContent = headerText;
        headerRow.appendChild(th);
    });
    const tbody = table.createTBody();
    data.rows.forEach(rowData => {
        const row = tbody.insertRow();
        rowData.forEach(cellData => {
            const td = row.insertCell();
            td.className = 'p-2 border border-slate-300 align-top';
            td.innerHTML = cellData;
        });
    });
    return table;
}

function createRatingTable(data) {
    const container = document.createElement('div');
    container.className = 'space-y-3 p-2';
    data.rows.forEach(rowData => {
        const rowDiv = document.createElement('div');
        const title = document.createElement('h5');
        title.className = 'font-bold text-sm md:text-base';
        title.textContent = rowData[0];
        rowDiv.appendChild(title);
        const ratingsDiv = document.createElement('div');
        ratingsDiv.className = 'flex items-center gap-4 text-xs md:text-sm';
        const oldRating = document.createElement('p');
        oldRating.innerHTML = `æ—§: <span class="text-gray-500">${rowData[1]}</span>`;
        const newRating = document.createElement('p');
        newRating.innerHTML = `æ–°: <span class="font-bold text-green-600">${rowData[2]}</span>`;
        ratingsDiv.appendChild(oldRating);
        ratingsDiv.appendChild(newRating);
        rowDiv.appendChild(ratingsDiv);
        container.appendChild(rowDiv);
    });
    return container;
}

function simpleMarkdownToHtml(markdown) {
    return markdown
        .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>') 
        .replace(/\* (.*?)(?=\n\* |$)/g, '<li>$1</li>') 
        .replace(/<li>/g, '<ul><li>')
        .replace(/<\/li>(?!<ul>)/g, '</li></ul>')
        .replace(/<\/li><\/ul><ul><li>/g, '</li><li>')
        .replace(/### (.*?)\n/g, '<h3>$1</h3>')
        .replace(/\n/g, '<br>');
}

async function handleDeepDiveClick(index) {
    const slide = slidesData[index];
    modalContentArea.innerHTML = '<p class="text-center text-slate-500">AIãŒåˆ†æä¸­... ã—ã°ã‚‰ããŠå¾…ã¡ãã ã•ã„ã€‚</p>';
    aiModal.classList.remove('hidden');

    const prompt = `
        ä»¥ä¸‹ã®AIãƒ‹ãƒ¥ãƒ¼ã‚¹ã«ã¤ã„ã¦ã€ãƒ“ã‚¸ãƒã‚¹ãƒ‘ãƒ¼ã‚½ãƒ³å‘ã‘ã«ã€ã‚ˆã‚Šè©³ç´°ãªåˆ†æã‚’ã—ã¦ãã ã•ã„ã€‚
        å›ç­”ã¯ã€ç°¡æ½”ãªç®‡æ¡æ›¸ãã®ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³å½¢å¼ã§ã€ä»¥ä¸‹ã®3ã¤ã®è¦–ç‚¹ã‚’å«ã‚ã¦ãã ã•ã„ã€‚
        1. ### ãƒ“ã‚¸ãƒã‚¹ã¸ã®å…·ä½“çš„ãªå½±éŸ¿
        2. ### 3å¹´å¾Œã®æœªæ¥äºˆæ¸¬
        3. ### é–¢é€£ã™ã‚‹æ–°ãŸãªãƒ“ã‚¸ãƒã‚¹ãƒãƒ£ãƒ³ã‚¹

        ---
        **ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚¿ã‚¤ãƒˆãƒ«:** ${slide.title}
        **æ¦‚è¦:** ${slide.summary}
        **ãƒã‚¤ãƒ³ãƒˆ:** ${slide.point}
    `;

    try {
        let chatHistory = [{ role: "user", parts: [{ text: prompt }] }];
        const payload = { contents: chatHistory };
        const apiKey = ""; // APIã‚­ãƒ¼ã¯ç©ºã®ã¾ã¾ã«ã—ã¾ã™
        const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;
        
        const response = await fetch(apiUrl, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(payload)
        });

        if (!response.ok) {
            throw new Error(`API error: ${response.statusText}`);
        }

        const result = await response.json();

        if (result.candidates && result.candidates.length > 0) {
            const text = result.candidates[0].content.parts[0].text;
            modalContentArea.innerHTML = simpleMarkdownToHtml(text);
        } else {
             modalContentArea.innerHTML = '<p class="text-red-500">AIã‹ã‚‰ã®æœ‰åŠ¹ãªå›ç­”ã‚’å¾—ã‚‰ã‚Œã¾ã›ã‚“ã§ã—ãŸã€‚</p>';
        }
    } catch (error) {
        console.error('Error fetching from Gemini API:', error);
        modalContentArea.innerHTML = `<p class="text-red-500">åˆ†æä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ãƒ­ã‚°ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚</p><p class="text-xs text-gray-500 mt-2">${error.message}</p>`;
    }
}

slidesData.forEach((slide, index) => {
    const slideEl = document.createElement('div');
    slideEl.className = 'slide absolute w-full h-full p-6 flex flex-col justify-between';
    slideEl.id = `slide-${index}`;

    let visualEl;
    if (slide.visual_type === 'flowchart') visualEl = createFlowchart(slide.visual_data);
    else if (slide.visual_type === 'table') visualEl = createTable(slide.visual_data);
    else if (slide.visual_type === 'table_rating') visualEl = createRatingTable(slide.visual_data);
    else if (slide.visual_type === 'custom') {
        visualEl = document.createElement('div');
        visualEl.className = 'w-full h-full flex items-center justify-center p-4';
        visualEl.innerHTML = slide.html;
    } else if (slide.visual_type === 'chart') {
        visualEl = document.createElement('div');
        visualEl.className = 'chart-container';
        const canvas = document.createElement('canvas');
        canvas.id = `chart-${index}`;
        visualEl.appendChild(canvas);
        charts.push({ index: index, config: slide.visual_data });
    }

    slideEl.innerHTML = `
        <div class="flex justify-between items-start">
            <div>
                <h2 class="text-lg md:text-xl font-bold text-slate-800">${slide.title}</h2>
                <p class="text-sm text-slate-500 font-medium">${slide.tool}</p>
            </div>
            <button class="deep-dive-btn bg-sky-500 text-white text-xs font-bold py-1 px-3 rounded-full hover:bg-sky-600 transition-colors" data-index="${index}">âœ¨ AIã§æ·±æ˜ã‚Š</button>
        </div>
        
        <div class="flex-grow my-4 grid grid-cols-1 md:grid-cols-2 gap-4 items-center overflow-auto">
            <div class="text-sm md:text-base text-slate-700 space-y-3">
                <p><strong>æ¦‚è¦:</strong> ${slide.summary}</p>
                <div><strong class="text-green-600">ãƒ¡ãƒªãƒƒãƒˆ:</strong><ul class="list-disc list-inside">${slide.merits.map(item => `<li>${item}</li>`).join('')}</ul></div>
                <div><strong class="text-red-600">ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ:</strong><ul class="list-disc list-inside">${slide.demerits.map(item => `<li>${item}</li>`).join('')}</ul></div>
            </div>
            <div class="h-full flex items-center justify-center">${visualEl ? visualEl.outerHTML : ''}</div>
        </div>

        <div class="bg-slate-100 p-3 rounded-lg border-l-4 border-slate-500">
            <p class="text-sm md:text-base font-semibold">ğŸš€ æ¥­å‹™åŠ¹ç‡åŒ–ã®ãƒã‚¤ãƒ³ãƒˆ</p>
            <p class="text-xs md:text-sm text-slate-600">${slide.point}</p>
        </div>
    `;
    slideshowContainer.appendChild(slideEl);
});

function showSlide(n) {
    const slides = document.querySelectorAll('.slide');
    slides.forEach((slide, index) => slide.classList.toggle('active', index === n));
    slideCounter.textContent = `${n + 1} / ${slides.length}`;
    prevBtn.disabled = n === 0;
    nextBtn.disabled = n === slides.length - 1;
    currentSlide = n;

    const chartConfig = charts.find(c => c.index === n);
    if (chartConfig && !chartConfig.instance) {
        const ctx = document.getElementById(`chart-${n}`).getContext('2d');
        chartConfig.instance = new Chart(ctx, {
            type: chartConfig.config.type,
            data: chartConfig.config,
            options: chartConfig.config.options || {}
        });
    }
}

prevBtn.addEventListener('click', () => {
    if (currentSlide > 0) showSlide(currentSlide - 1);
});

nextBtn.addEventListener('click', () => {
    if (currentSlide < slidesData.length - 1) showSlide(currentSlide + 1);
});

slideshowContainer.addEventListener('click', (event) => {
    if (event.target.classList.contains('deep-dive-btn')) {
        const index = parseInt(event.target.getAttribute('data-index'));
        handleDeepDiveClick(index);
    }
});

closeModalBtn.addEventListener('click', () => aiModal.classList.add('hidden'));
aiModal.addEventListener('click', (event) => {
    if(event.target === aiModal) aiModal.classList.add('hidden');
});


showSlide(0);

</script>

</body>
</html>
